<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>mysql数据库基础 | technology-column of Yolukami</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1 数据库定义​        数据库（database）就是一个存储数据的仓库。为了方便数据的存储和管理，它将数据按照特定的规律存储在磁盘上。通过数据库管理系统，可以有效地组织和管理存储在数据库中的数据   相关基本概念： ​        数据库服务器。是指用来运行数据库服务的一台电脑。小型项目通常为一台，中大型项目通常是多台数据库服务器共同来存储或计算。由于数据安全非常重要，所以我们需要对数">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql数据库基础">
<meta property="og:url" content="http://yolukami.com/2021/10/11/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="technology-column of Yolukami">
<meta property="og:description" content="1 数据库定义​        数据库（database）就是一个存储数据的仓库。为了方便数据的存储和管理，它将数据按照特定的规律存储在磁盘上。通过数据库管理系统，可以有效地组织和管理存储在数据库中的数据   相关基本概念： ​        数据库服务器。是指用来运行数据库服务的一台电脑。小型项目通常为一台，中大型项目通常是多台数据库服务器共同来存储或计算。由于数据安全非常重要，所以我们需要对数">
<meta property="og:locale">
<meta property="article:published_time" content="2021-10-10T16:00:00.000Z">
<meta property="article:modified_time" content="2021-11-11T08:59:38.943Z">
<meta property="article:author" content="Yolukami">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="technology-column of Yolukami" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">technology-column of Yolukami</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yolukami.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-数据库基础知识/mysql数据库基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/11/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2021-10-10T16:00:00.000Z" itemprop="datePublished">2021-10-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/">MySQL数据库</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      mysql数据库基础
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-数据库定义"><a href="#1-数据库定义" class="headerlink" title="1 数据库定义"></a>1 数据库定义</h1><p>​        数据库（database）就是一个存储数据的仓库。为了方便数据的存储和管理，它将数据按照特定的规律存储在磁盘上。通过数据库管理系统，可以有效地组织和管理存储在数据库中的数据  </p>
<h2 id="相关基本概念："><a href="#相关基本概念：" class="headerlink" title="相关基本概念："></a>相关基本概念：</h2><blockquote>
<p>​        <strong>数据库服务器</strong>。是指用来运行数据库服务的一台电脑。小型项目通常为一台，中大型项目通常是多台数据库服务器共同来存储或计算。由于数据安全非常重要，所以我们需要对数据库服务器里面的数据进经备份管理。  </p>
<p>​        <strong>数据库。</strong>一个数据库服务器里面有可以有多个数据库。主要用来分类使用。我们可以建立学员管理系统数据库、电子商城数据库、CRM数据库、ERP数据库等等，主要用来将各个不同用途的数据，按照业务进行划分。  </p>
<p>​        <strong>数据表</strong>。例如在学员管理系统数据库中。根据业务的不同又分为了不同的数据表。专门用来存放不同人员的数据。例如：学员数据表（学号、用户名、密码）；老师数据表（用户名、密码，工作经验） </p>
<p>​        <strong>数据字段</strong>，也叫数据列。就是我们日常所见表格里面的列。在表格中，我们会将一张用户表分成多个列。如下（表一）所示：用户编号、用户名、性别、年龄是字段。在真正的数据库中数据字段需要换成英文需要写成：id、username、sex、age。   </p>
<p>​        <strong>数据行。</strong>真正的数据存在每一个表的行里面。字段（列）划分出来了一个表应该按照什么样的格式存数据。而行，是真正的数据。每一行需要遵循数据字段（列）的规范和要求进行存入数据。  </p>
</blockquote>
<h1 id="2-MySQL-简介"><a href="#2-MySQL-简介" class="headerlink" title="2 MySQL 简介"></a>2 MySQL 简介</h1><p>​        MySQL是一款完全免费的产品，用户可以直接从网上下载使用，而不必支付任何费用。此外，MySQL数据库的跨平台性也是其一个很大的优势之一。  MySQL是一个真正的多用户、多线程SQL数据库服务器。它是以客户机/服务器结构实现的，由一个服务器守护程序以及很多不同的客户程序和库组成  </p>
<p>​        MySQL 5.5融合了MySQL数据库和InnoDB存储引擎的优点，能够提供高性能的数据管理解决方案，包括：  InnoDB作为默认的数据库存储引擎。  改善性能和可扩展性，全面利用各平台现代、多核构架的计算能力。  提高实用性。  提高易管理性和效率。  提高可用性。  </p>
<h2 id="2-1-MySQL安装"><a href="#2-1-MySQL安装" class="headerlink" title="2.1 MySQL安装"></a>2.1 MySQL安装</h2><p><strong>官方下载地址:</strong>  <a target="_blank" rel="noopener" href="http://dev.mysql.com/downloads/mysql/">http://dev.mysql.com/downloads/mysql/</a> </p>
<p>安装教程：</p>
<p>安装注意：</p>
<ol>
<li>服务端口：3306，不建议更改</li>
<li>字符集编码：utf8</li>
<li>用户名和密码尽量简单 （用户名：root  密码：root）</li>
<li>配置环境变量之后才能在cmd窗口中操作。（不配置也可以使用可视化工具（Navicat）正常使用）</li>
</ol>
<p>安装成功之后，在电脑服务中能够查看到mysql的服务，也可以在cmd窗口输入：mysql -V  查看版本信息。</p>
<h2 id="2-2-启动MySQL服务"><a href="#2-2-启动MySQL服务" class="headerlink" title="2.2 启动MySQL服务"></a>2.2 启动MySQL服务</h2><p>1.“我的电脑”→“管理”→“服务”在服务器的列表中找到mysql服务并右键单击，在弹出的快捷菜单中，完成MySQL服务的各种操作（启动、重新启动、停止、暂停和恢复）</p>
<p> 2.cmd窗口启动服务：Window键+x   启动：net start mysql  停止：net stop mysql</p>
<h2 id="2-3-登录MySQL"><a href="#2-3-登录MySQL" class="headerlink" title="2.3 登录MySQL"></a>2.3 登录MySQL</h2><p>cmd窗口登录：</p>
<ol>
<li>mysql -root -p</li>
<li>Enter password： ***（输入密码）</li>
</ol>
<h1 id="3-SQL语言"><a href="#3-SQL语言" class="headerlink" title="3 SQL语言"></a>3 SQL语言</h1><h2 id="3-1-DDL：数据定义语言"><a href="#3-1-DDL：数据定义语言" class="headerlink" title="3.1 DDL：数据定义语言"></a>3.1 DDL：数据定义语言</h2><p>​        (DDL ，Data Defintion Language)语句：数据定义语句，用于定义不同的数据对象、数据库、表、列、索引等。常用的语句关键字包括create、drop、alter等。</p>
<h3 id="3-1-1-DDL操作数据库"><a href="#3-1-1-DDL操作数据库" class="headerlink" title="3.1.1 DDL操作数据库"></a>3.1.1 DDL操作数据库</h3><p>在cmd中登录mysql之后，可以使用这些DDL命令操作数据库(注：”;”符号表示语句结束，在单条命令时可以不加)</p>
<table>
<thead>
<tr>
<th>功能</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>显示所有的数据库：</td>
<td>show databases;</td>
</tr>
<tr>
<td>创建数据库：</td>
<td>create database   test[数据库名];</td>
</tr>
<tr>
<td>使用/进入 数据库：</td>
<td>use test[数据库名];</td>
</tr>
<tr>
<td>显示当前数据库所有的表：</td>
<td>show tables;</td>
</tr>
<tr>
<td>删除指定数据库：</td>
<td>drop database test[数据库名]</td>
</tr>
</tbody></table>
<h3 id="3-1-2-DDL操作数据表"><a href="#3-1-2-DDL操作数据表" class="headerlink" title="3.1.2 DDL操作数据表"></a>3.1.2 DDL操作数据表</h3><table>
<thead>
<tr>
<th>功能</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>创建表：</td>
<td>create table 表名(字段名 字段类型 ，…. ， 字段名 字段类型);</td>
</tr>
<tr>
<td>删除表：</td>
<td>drop table 表名;</td>
</tr>
<tr>
<td>修改表名：</td>
<td>alter table 旧表名 rename 新的表名;</td>
</tr>
</tbody></table>
<p>拓展：数据库的常用字段类型</p>
<blockquote>
<p>在MySQL里面我们将数据类型分为了以下一些类型：</p>
<p>\1.    数值类型（整型、浮点）</p>
<p>\2.    字符串类型</p>
<p>\3.    日期时间类型</p>
<p>\4.    复合类型</p>
<h4 id="整型"><a href="#整型" class="headerlink" title="整型"></a>整型</h4><table>
<thead>
<tr>
<th>MySQL数据类型</th>
<th>所占字节</th>
<th>值范围</th>
</tr>
</thead>
<tbody><tr>
<td>tinyint</td>
<td>1字节</td>
<td>-128~127</td>
</tr>
<tr>
<td>smallint</td>
<td>2字节</td>
<td>-32768~32767</td>
</tr>
<tr>
<td>mediumint</td>
<td>3字节</td>
<td>-8388608~8388607</td>
</tr>
<tr>
<td>int</td>
<td>4字节</td>
<td>范围-2147483648~2147483647</td>
</tr>
<tr>
<td>bigint</td>
<td>8字节</td>
<td>+-9.22*10的18次方</td>
</tr>
</tbody></table>
<p>UNSIGNED（无符号） 主要用于整型和浮点类型，使用无符号。即，没有前面面的-（负号）。<br> 存储位数更长。tinyint整型的取值区间为，-128~127。而使用无符号后可存储0-255个长度。</p>
<p>创建时在整型或浮点字段语句后接上：</p>
<p>Unsigned</p>
<h4 id="浮点类型"><a href="#浮点类型" class="headerlink" title="浮点类型"></a>浮点类型</h4><table>
<thead>
<tr>
<th>MySQL数据类型</th>
<th>所占字节</th>
<th>值范围</th>
</tr>
</thead>
<tbody><tr>
<td>float(m, d)</td>
<td>4字节</td>
<td>单精度浮点型，m总个数，d小数位</td>
</tr>
<tr>
<td>double(m, d)</td>
<td>8字节</td>
<td>双精度浮点型，m总个数，d小数位</td>
</tr>
<tr>
<td>decimal(m,  d)</td>
<td></td>
<td>decimal是存储为字符串的浮点数</td>
</tr>
</tbody></table>
<h4 id="字符类型"><a href="#字符类型" class="headerlink" title="字符类型"></a>字符类型</h4><table>
<thead>
<tr>
<th>MySQL数据类型</th>
<th>所占字节</th>
<th>值范围</th>
</tr>
</thead>
<tbody><tr>
<td>CHAR</td>
<td>0-255字节</td>
<td>定长字符串</td>
</tr>
<tr>
<td>VARCHAR</td>
<td>0-255字节</td>
<td>变长字符串</td>
</tr>
<tr>
<td>TINYBLOB</td>
<td>0-255字节</td>
<td>不超过255个字符的二进制字符串</td>
</tr>
<tr>
<td>TINYTEXT</td>
<td>0-255字节</td>
<td>短文本字符串</td>
</tr>
<tr>
<td>BLOB</td>
<td>0-65535字节</td>
<td>二进制形式的长文本数据</td>
</tr>
<tr>
<td>TEXT</td>
<td>0-65535字节</td>
<td>长文本数据</td>
</tr>
<tr>
<td>MEDIUMBLOB</td>
<td>0-16 777 215字节</td>
<td>二进制形式的中等长度文本数据</td>
</tr>
<tr>
<td>MEDIUMTEXT</td>
<td>0-16 777 215字节</td>
<td>中等长度文本数据</td>
</tr>
<tr>
<td>LOGNGBLOB</td>
<td>0-4 294 967  295字节</td>
<td>二进制形式的极大文本数据</td>
</tr>
<tr>
<td>LONGTEXT</td>
<td>0-4 294 967  295字节</td>
<td>极大文本数据</td>
</tr>
<tr>
<td>VARBINARY(M)</td>
<td>允许长度0-M个字节的定长字节符串</td>
<td>值的长度+1个字节</td>
</tr>
<tr>
<td>BINARY(M)</td>
<td>M</td>
<td>允许长度0-M个字节的定长字节符串</td>
</tr>
</tbody></table>
<h4 id="时间类型"><a href="#时间类型" class="headerlink" title="时间类型"></a>时间类型</h4><table>
<thead>
<tr>
<th>MySQL数据类型</th>
<th>所占字节</th>
<th>值范围</th>
</tr>
</thead>
<tbody><tr>
<td>date</td>
<td>3字节</td>
<td>日期，格式：2014-09-18</td>
</tr>
<tr>
<td>time</td>
<td>3字节</td>
<td>时间，格式：08:42:30</td>
</tr>
<tr>
<td>datetime</td>
<td>8字节</td>
<td>日期时间，格式：2014-09-18  08:42:30</td>
</tr>
<tr>
<td>timestamp</td>
<td>4字节</td>
<td>自动存储记录修改的时间</td>
</tr>
<tr>
<td>year</td>
<td>1字节</td>
<td>年份</td>
</tr>
</tbody></table>
<p>注意：</p>
<p>\1.   时间类型在web系统中用的比较少，很多时候很多人喜欢使用int来存储时间。插入时插入的是unix时间戳，因为这种方式更方便计算。在前端业务中用date类型的函数，再将unix时间戳转成人们可识别的时间。</p>
<p>\2.   上面的类型你可以根据实际情况实际进行选择</p>
<p>有些人为了在数据库管理中方便查看，也有人使用datetime</p>
</blockquote>
<h3 id="3-1-3-DDL操作数据表字段"><a href="#3-1-3-DDL操作数据表字段" class="headerlink" title="3.1.3 DDL操作数据表字段"></a>3.1.3 DDL操作数据表字段</h3><table>
<thead>
<tr>
<th>功能</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>修改字段类型</td>
<td>alter table 表名 modify 字段名 varchar(20);</td>
</tr>
<tr>
<td>增加表字段</td>
<td>alter table 表名 add 字段名 类型;</td>
</tr>
<tr>
<td>删除表字段</td>
<td>alter table 表名 drop column 字段名;</td>
</tr>
<tr>
<td>修改字段名</td>
<td>alter table 表名 change 字段原名 字段新名 字段类型;</td>
</tr>
</tbody></table>
<h2 id="3-2-DML：数据操作语言"><a href="#3-2-DML：数据操作语言" class="headerlink" title="3.2 DML：数据操作语言"></a>3.2 DML：数据操作语言</h2><p>​        (DML ， Data Manipulation Language)语句：数据操纵语句，用于添加、删除、更新和查询数据库记录，并检查数据的完整性。常用的语句关键字主要包括insert、delete、update和select等。（DML:添加，修改，删除，DQL:查询）</p>
<p>功能：增删查改（CRUD）  </p>
<p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"># 添加数据 <span class="operator">-</span> 方式<span class="number">1</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;小明&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">21</span>,<span class="number">11000</span>,<span class="string">&#x27;Java&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># 添加数据 <span class="operator">-</span> 方式<span class="number">2</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(name,sex,age,salary,course) <span class="keyword">VALUES</span>(<span class="string">&#x27;小华&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">28</span>,<span class="number">10000</span>,<span class="string">&#x27;Java&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(name,sex,age,salary,course) <span class="keyword">VALUES</span>(<span class="string">&#x27;小川&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">26</span>,<span class="number">12000</span>,<span class="string">&#x27;Java&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(name,sex,age,salary,course) <span class="keyword">VALUES</span>(<span class="string">&#x27;小刘&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">60</span>,<span class="number">8000</span>,<span class="string">&#x27;HTML&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(name,sex,age,salary,course) <span class="keyword">VALUES</span>(<span class="string">&#x27;小城&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">31</span>,<span class="number">9000</span>,<span class="string">&#x27;HTML&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(name,sex,age,salary,course) <span class="keyword">VALUES</span>(<span class="string">&#x27;小得&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">33</span>,<span class="number">11000</span>,<span class="string">&#x27;Python&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student(name,sex,age,salary,course) <span class="keyword">VALUES</span>(<span class="string">&#x27;欧阳&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="number">40</span>,<span class="number">7000</span>,<span class="string">&#x27;Python&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># 修改 <span class="operator">-</span> 所有更改字段都修改值</span><br><span class="line">UPDATE student <span class="keyword">SET</span> sex<span class="operator">=</span><span class="string">&#x27;男&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># 修改 <span class="operator">-</span> 加单个条件</span><br><span class="line">UPDATE student <span class="keyword">SET</span> age<span class="operator">=</span><span class="number">18</span> <span class="keyword">WHERE</span> age<span class="operator">&gt;</span><span class="number">40</span>;</span><br><span class="line"></span><br><span class="line"># 修改 <span class="operator">-</span> 加多个条件 <span class="keyword">and</span><span class="operator">-</span>并且</span><br><span class="line">UPDATE student <span class="keyword">SET</span> age<span class="operator">=</span><span class="number">18</span> <span class="keyword">WHERE</span> age<span class="operator">&gt;</span><span class="number">25</span> <span class="keyword">AND</span> course<span class="operator">=</span><span class="string">&#x27;Java&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># 修改 <span class="operator">-</span> 加多个条件 <span class="keyword">or</span><span class="operator">-</span>或者</span><br><span class="line">UPDATE student <span class="keyword">SET</span> age<span class="operator">=</span><span class="number">18</span> <span class="keyword">WHERE</span> age<span class="operator">&gt;</span><span class="number">25</span> <span class="keyword">OR</span> course<span class="operator">=</span><span class="string">&#x27;Java&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># 删除 <span class="operator">-</span> 清空表数据</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> student;# 再添加数据，id会从之前的自动增长</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> student; # 再添加数据，id从<span class="number">1</span>开始</span><br><span class="line"></span><br><span class="line"># 删除 <span class="operator">-</span> 加条件</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 查询所有字段</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 指定字段</span><br><span class="line"><span class="keyword">SELECT</span> name,age <span class="keyword">FROM</span> student;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 加条件</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> age <span class="operator">&lt;</span> <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 模糊查询（工作中不使用）</span><br><span class="line"># <span class="operator">%</span>表示没有或多个字符</span><br><span class="line"># _表示一个字符</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%华%&#x27;</span>; </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%华&#x27;</span>; </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;__华&#x27;</span>; </span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 排序</span><br><span class="line"># <span class="keyword">ASC</span><span class="operator">-</span>升序	<span class="keyword">DESC</span><span class="operator">-</span>降序</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">ORDER</span> <span class="keyword">BY</span> age <span class="keyword">ASC</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">ORDER</span> <span class="keyword">BY</span> age <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 去重</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> course <span class="keyword">FROM</span> student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span>限制</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span><span class="keyword">FROM</span> student LIMIT <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"># 需求：获取学生中前三的高薪资学院</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span> LIMIT <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span>分页（需求：每一页展示<span class="number">3</span>条数据）</span><br><span class="line"># 分页公式：<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT (当前页<span class="number">-1</span>)<span class="operator">*</span>条数,条数;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">0</span>,<span class="number">3</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">3</span>,<span class="number">3</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">6</span>,<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span>统计类<span class="operator">/</span>聚合函数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(salary) <span class="keyword">FROM</span> student;# 获取学生薪资之和</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(id) <span class="keyword">FROM</span> student; # 获取表中数据的条数</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> student; # 获取最高工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary) <span class="keyword">FROM</span> student; # 获取最低工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> student; # 获取平均薪资</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span>子查询</span><br><span class="line"># 需求：查询出最高的工资的学生</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> salary<span class="operator">=</span>(<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> student);</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span>分组过滤</span><br><span class="line"># 需求：查询每个学科的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> course,<span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> student <span class="keyword">GROUP</span> <span class="keyword">BY</span> course;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span>分组过滤 <span class="operator">+</span> 条件</span><br><span class="line"># 需求：查询平均工资<span class="operator">&gt;</span><span class="number">10000</span>的学科</span><br><span class="line"><span class="keyword">SELECT</span> course,<span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> student <span class="keyword">GROUP</span> <span class="keyword">BY</span> course <span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary)<span class="operator">&gt;</span><span class="number">10000</span>;</span><br><span class="line"># 查询数据 <span class="operator">-</span> 限制</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"># 需求：获取学生中前<span class="number">3</span>高薪资的学员信息</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span> LIMIT <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 分页（需求：每一页展示<span class="number">3</span>条数据）</span><br><span class="line"># <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT 偏移量,获取条数;</span><br><span class="line"># 分页公式：<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT (当前页<span class="number">-1</span>)<span class="operator">*</span>条数,条数;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">0</span>,<span class="number">3</span>;# 第<span class="number">1</span>页</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">3</span>,<span class="number">3</span>;# 第<span class="number">2</span>页 </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student LIMIT <span class="number">6</span>,<span class="number">3</span>;# 第<span class="number">3</span>页</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 统计类<span class="operator">/</span>聚合函数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(salary) <span class="keyword">FROM</span> student;# 需求：获取所有学生的工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(id) <span class="keyword">FROM</span> student;# 需求：获取表中数据的条数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> student;# 需求：获取学生的最高工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary) <span class="keyword">FROM</span> student;# 需求：获取学生的最低工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> student;# 需求：获取学生的平均工资</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 子查询</span><br><span class="line"># 需求：查询出最高工资的学生信息</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> salary<span class="operator">=</span>(<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> student);</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 分组过滤	</span><br><span class="line"># 需求：查询每个学科的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> course,<span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> student <span class="keyword">GROUP</span> <span class="keyword">BY</span> course;</span><br><span class="line"></span><br><span class="line"># 查询数据 <span class="operator">-</span> 分组过滤	<span class="operator">+</span> 条件</span><br><span class="line"># 需求：查询平均工资<span class="operator">&gt;</span><span class="number">10000</span>学科的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> course,<span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> student <span class="keyword">GROUP</span> <span class="keyword">BY</span> course <span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary)<span class="operator">&gt;</span><span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"># 多表联合查询</span><br><span class="line"></span><br><span class="line"># 内连接（多表数据由联系才能查询出来）</span><br><span class="line"><span class="keyword">SELECT</span>	s.name,t.name <span class="keyword">FROM</span> student s,teacher t <span class="keyword">WHERE</span> s.t_id<span class="operator">=</span>t.id;</span><br><span class="line"><span class="keyword">SELECT</span>	s.name <span class="keyword">AS</span> <span class="string">&#x27;学生姓名&#x27;</span>,t.name <span class="keyword">AS</span> <span class="string">&#x27;老师姓名&#x27;</span> <span class="keyword">FROM</span> student s <span class="keyword">INNER</span> <span class="keyword">JOIN</span> teacher t <span class="keyword">ON</span> s.t_id<span class="operator">=</span>t.id;</span><br><span class="line"></span><br><span class="line"># 左连接</span><br><span class="line"><span class="keyword">SELECT</span>	s.name,t.name <span class="keyword">FROM</span> student s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> teacher t <span class="keyword">ON</span> s.t_id<span class="operator">=</span>t.id;</span><br><span class="line"></span><br><span class="line"># 右连接	</span><br><span class="line"><span class="keyword">SELECT</span>	s.name,t.name <span class="keyword">FROM</span> student s <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> teacher t <span class="keyword">ON</span> s.t_id<span class="operator">=</span>t.id;</span><br><span class="line"></span><br><span class="line"># 查询内容合并</span><br><span class="line"><span class="keyword">SELECT</span>	s.name,t.name <span class="keyword">FROM</span> student s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> teacher t <span class="keyword">ON</span> s.t_id<span class="operator">=</span>t.id</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span>	s.name,t.name <span class="keyword">FROM</span> student s <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> teacher t <span class="keyword">ON</span> s.t_id<span class="operator">=</span>t.id;</span><br><span class="line"></span><br><span class="line"># 全链接（合并查询结果并去重）</span><br><span class="line"><span class="keyword">SELECT</span>	s.name,t.name <span class="keyword">FROM</span> student s <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> teacher t <span class="keyword">ON</span> s.t_id<span class="operator">=</span>t.id</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span>	s.name,t.name <span class="keyword">FROM</span> student s <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> teacher t <span class="keyword">ON</span> s.t_id<span class="operator">=</span>t.id;</span><br></pre></td></tr></table></figure>

<h2 id="3-3-DCL：数据控制语言"><a href="#3-3-DCL：数据控制语言" class="headerlink" title="3.3 DCL：数据控制语言"></a>3.3 DCL：数据控制语言</h2><p>​        (DCL， Data Control Language)语句：数据控制语句，用于控制不同数据段直接的许可和访问级别的语句。这些语句定义了数据库、表、字段、用户的访问权限和安全级别。主要的语句关键字包括grant、revoke等。  </p>
<p>含义：给子账户开辟权限</p>
<p>\1.  开辟子账户：CREATE USER ‘用户名‘@’localhost’ IDENTIFIED BY ‘密码’;</p>
<p>\2.  给定权限：GRANT权限 ON 库.表 TO  ‘用户‘@’localhost’ IDENTIFIED BY ‘密码’;</p>
<p>\3.  删除权限：REVOKE 权限 ON 库.表 FROM ‘用户‘@’localhost’;</p>
<p>注意：权限-insert、delete、select、update</p>
<p>参数说明</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>grant all</td>
<td>在grant后接all说明给予所有权限</td>
</tr>
<tr>
<td>revoke all</td>
<td>在revoke后接all说明删除所有权限</td>
</tr>
<tr>
<td>权限 on <em>.</em></td>
<td><em>.</em> 所明给予所有库所有表的操作权限</td>
</tr>
<tr>
<td>‘用户‘@’主机’</td>
<td>主机里面若为%。任意来源的主机均可以使用这个用户来访问</td>
</tr>
</tbody></table>
<p> 解决编码问题：Set charset gbk;  </p>
<h1 id="4-拓展："><a href="#4-拓展：" class="headerlink" title="4 拓展："></a>4 拓展：</h1><h2 id="4-1-约束"><a href="#4-1-约束" class="headerlink" title="4.1 约束"></a>4.1 约束</h2><p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"># 约束是一种限制，它通过对表的行或列的数据做出限制，来确保表的数据的完整性、唯一性。</span><br><span class="line"></span><br><span class="line"># 主键约束：唯一约束 <span class="operator">+</span> 非空约束</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student(id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY);# 创建表时，设置主键约束</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> <span class="keyword">primary</span> key(id);# 添加主键约束</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> <span class="keyword">primary</span> key;# 删除主键约束</span><br><span class="line"><span class="keyword">alter</span>  <span class="keyword">table</span> student modify id <span class="type">int</span>(<span class="number">3</span>) <span class="keyword">primary</span> key# 修改主键约束</span><br><span class="line"></span><br><span class="line"># 唯一约束：不允许出现重复的值，但是可以为多个<span class="keyword">null</span>。</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(# 创建表时，设置唯一约束</span><br><span class="line">    id <span class="type">int</span>(<span class="number">3</span>) <span class="keyword">PRIMARY</span> KEY ,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="keyword">unique</span>(name)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> <span class="keyword">unique</span> (name);# 添加唯一约束</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student modify name <span class="type">varchar</span>(<span class="number">40</span>) <span class="keyword">unique</span>;# 修改唯一约束</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> name;# 删除约束</span><br><span class="line"></span><br><span class="line"># 非空约束：不允许为<span class="keyword">null</span></span><br><span class="line"># 设置默认值</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(# 创建表时，添加非空约束</span><br><span class="line">		 id <span class="type">int</span>(<span class="number">3</span>) <span class="keyword">PRIMARY</span> KEY ,</span><br><span class="line">		 name <span class="type">varchar</span>(<span class="number">32</span>),</span><br><span class="line">		 sex <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student modify sex <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">not</span> <span class="keyword">null</span>;# 增加非空约束</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student modify sex <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">null</span>;# 取消非空约束</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student modify sex <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">default</span> <span class="string">&#x27;abc&#x27;</span> <span class="keyword">null</span>;# 取消非空约束，增加默认值</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 外键约束：保证多表之间的参照完整性，外键是构建于一个表的两个字段或是两个表的两个字段之间的参照关系</span><br><span class="line"></span><br><span class="line"># 添加外键</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> <span class="keyword">foreign</span> key(t_id) <span class="keyword">references</span> teacher(id);</span><br><span class="line"></span><br><span class="line"># 删除外键（<span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student 找到外键的名字）</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> <span class="keyword">foreign</span> key student_ibfk_1;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="4-2-索引"><a href="#4-2-索引" class="headerlink" title="4.2 索引"></a>4.2 索引</h2><p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># 索引：让该字段的查询效率更高</span><br><span class="line"></span><br><span class="line"># 主键索引：该字段的值不能为<span class="keyword">null</span>且并重复</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student(id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY);# 创建表时，设置主键索引</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> <span class="keyword">primary</span> key(id);# 添加主键索引</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> <span class="keyword">primary</span> key;# 删除主键索引</span><br><span class="line"><span class="keyword">alter</span>  <span class="keyword">table</span> student modify id <span class="type">int</span>(<span class="number">3</span>) <span class="keyword">primary</span> key# 修改主键索引</span><br><span class="line"></span><br><span class="line"># 唯一索引：不允许出现重复的值，但是可以为多个<span class="keyword">null</span>。</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(# 创建表时，设置唯一索引</span><br><span class="line">    id <span class="type">int</span>(<span class="number">3</span>) <span class="keyword">PRIMARY</span> KEY ,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    <span class="keyword">unique</span>(name)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> <span class="keyword">unique</span> (name);# 添加唯一索引</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student modify name <span class="type">varchar</span>(<span class="number">40</span>) <span class="keyword">unique</span>;# 修改唯一索引</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">drop</span> name;# 删除唯一索引</span><br><span class="line"></span><br><span class="line"># 普通索引</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> student <span class="keyword">add</span> index(name);# 添加普通索引</span><br><span class="line"><span class="keyword">drop</span> index name <span class="keyword">on</span> student;# 删除普通索引</span><br><span class="line"></span><br><span class="line"># 索引的缺点：在添加、删除、修改数据时，会改动B<span class="operator">+</span>Tree的结构</span><br><span class="line"># 解决方案：批量操作数据时，先把索引删掉，等批量操作数据后，再把索引添加上</span><br><span class="line"></span><br><span class="line"># 所有的分类：聚簇索引（主键）、非聚簇索引</span><br><span class="line"># 在InnoDB的引擎下，所有的索引底层数据结构都是B<span class="operator">+</span>Tree</span><br><span class="line"># 聚簇索引（主键）：叶子节点存的是数据</span><br><span class="line"># 非聚簇索引：叶子节点存的是主键</span><br></pre></td></tr></table></figure>

<p>btree和B+tree的区别：</p>
<p> B树的特点：<br>（1）所有键值分布在整个树中<br>（2）任何关键字出现且只出现在一个节点中<br>（3）搜索有可能在非叶子节点结束<br>（4）在关键字全集内做一次查找，性能逼近二分查找算法 </p>
<p>B+Tree树的特点：</p>
<p> （1）所有关键字存储在叶子节点，非叶子节点不存储真正的data    </p>
<p> （2）为所有叶子节点增加了一个链指针 </p>
<h2 id="4-3-视图"><a href="#4-3-视图" class="headerlink" title="4.3 视图"></a>4.3 视图</h2><p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 创建视图</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> VIEW_1 <span class="keyword">as</span> <span class="keyword">SELECT</span> name,age,course <span class="keyword">FROM</span>  student <span class="keyword">WHERE</span> age<span class="operator">&gt;</span><span class="number">30</span> <span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION;</span><br><span class="line"></span><br><span class="line"># 查询视图</span><br><span class="line"><span class="keyword">SELECT</span><span class="operator">*</span> <span class="keyword">FROM</span> view_1;</span><br><span class="line"></span><br><span class="line"># 修改视图</span><br><span class="line">UPDATE VIEW_1 <span class="keyword">set</span> age<span class="operator">=</span><span class="number">50</span> <span class="keyword">WHERE</span> name<span class="operator">=</span><span class="string">&#x27;小刘&#x27;</span>;</span><br><span class="line">UPDATE VIEW_1 <span class="keyword">set</span> age<span class="operator">=</span><span class="number">20</span> <span class="keyword">WHERE</span> name<span class="operator">=</span><span class="string">&#x27;小刘&#x27;</span>;#不满足视图的<span class="keyword">WHERE</span>条件，执行将要报错，且不会修改</span><br><span class="line"></span><br><span class="line"># 删除视图</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> VIEW_1;</span><br></pre></td></tr></table></figure>

<h2 id="4-4-触发器"><a href="#4-4-触发器" class="headerlink" title="4.4 触发器"></a>4.4 触发器</h2><p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># 需求：插入学生，并且班级表和学科表都要更新数据</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student(name,class_id,course_id) <span class="keyword">values</span>(<span class="string">&#x27;小玲&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student(name,class_id,course_id) <span class="keyword">values</span>(<span class="string">&#x27;李科&#x27;</span>,<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student(name,class_id,course_id) <span class="keyword">values</span>(<span class="string">&#x27;小红&#x27;</span>,<span class="number">3</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student(name,class_id,course_id) <span class="keyword">values</span>(<span class="string">&#x27;小黄&#x27;</span>,<span class="number">4</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student(name,class_id,course_id) <span class="keyword">values</span>(<span class="string">&#x27;小绿&#x27;</span>,<span class="number">4</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> student(name,class_id,course_id) <span class="keyword">values</span>(<span class="string">&#x27;小王&#x27;</span>,<span class="number">5</span>,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 创建触发器</span><br><span class="line"># student执行了<span class="keyword">insert</span>事件后执行 update操作</span><br><span class="line">delimiter xx</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> t1 after <span class="keyword">insert</span> <span class="keyword">on</span> student <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span> </span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		update class <span class="keyword">set</span> sum<span class="operator">=</span>sum<span class="operator">+</span><span class="number">1</span> <span class="keyword">where</span> id <span class="operator">=</span> new.class_id;	</span><br><span class="line">		update course <span class="keyword">set</span> sum<span class="operator">=</span>sum<span class="operator">+</span><span class="number">1</span> <span class="keyword">where</span> id <span class="operator">=</span> new.course_id;</span><br><span class="line">	<span class="keyword">END</span> xx</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 需求：删除学生，并且班级表和学科表都要更新数据</span><br><span class="line"># student执行了<span class="keyword">delete</span>事件前执行 update操作</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">FROM</span> student <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">FROM</span> student <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">FROM</span> student <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">delimiter xx</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> t2 before <span class="keyword">delete</span> <span class="keyword">on</span> student <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span> </span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		update class <span class="keyword">set</span> sum<span class="operator">=</span>sum<span class="number">-1</span> <span class="keyword">where</span> id <span class="operator">=</span> old.class_id;	</span><br><span class="line">		update course <span class="keyword">set</span> sum<span class="operator">=</span>sum<span class="number">-1</span> <span class="keyword">where</span> id <span class="operator">=</span> old.course_id;</span><br><span class="line">	<span class="keyword">END</span> xx</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"># new.字段：当前写法可以获得添加语句字段对应的值</span><br><span class="line"># old.字段：当前写法可以获得删除语句字段对应的值</span><br><span class="line"></span><br><span class="line"># delimiter xx 设置一条执行语句的结束符为 xx</span><br></pre></td></tr></table></figure>

<h2 id="4-5-存储过程"><a href="#4-5-存储过程" class="headerlink" title="4.5 存储过程"></a>4.5 存储过程</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"># 最简单的存储过程</span><br><span class="line">delimiter XX</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> myprocedure01()</span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student;</span><br><span class="line">		<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> teacher;</span><br><span class="line">	<span class="keyword">END</span> XX</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"># 调用存储过程</span><br><span class="line"><span class="keyword">CALL</span> myprocedure01();</span><br><span class="line"></span><br><span class="line"># 存储过程可以传值</span><br><span class="line"># <span class="keyword">IN</span></span><br><span class="line"># <span class="keyword">OUT</span></span><br><span class="line"># <span class="keyword">INOUT</span></span><br><span class="line"></span><br><span class="line"># 需求：查询指定学生的id</span><br><span class="line">delimiter XX</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> myprocedure02(<span class="keyword">IN</span> s_id <span class="type">int</span>(<span class="number">3</span>))</span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id<span class="operator">=</span>s_id;</span><br><span class="line">	<span class="keyword">END</span> XX</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"># 调用存储过程</span><br><span class="line"><span class="keyword">CALL</span> myprocedure02(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"># 需求：查询指定id 的学生所属的老师name，并返回</span><br><span class="line">delimiter XX</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> myprocedure03(<span class="keyword">IN</span> s_id <span class="type">int</span>(<span class="number">3</span>),<span class="keyword">OUT</span> t_name <span class="type">VARCHAR</span>(<span class="number">32</span>))</span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		<span class="keyword">SELECT</span> `name` <span class="keyword">INTO</span> t_name <span class="keyword">FROM</span> teacher <span class="keyword">WHERE</span> id<span class="operator">=</span>(<span class="keyword">SELECT</span> t_id <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id<span class="operator">=</span>s_id);</span><br><span class="line">	<span class="keyword">END</span> XX</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"># 调用存储过程</span><br><span class="line"><span class="keyword">CALL</span> myprocedure03(<span class="number">1</span>,<span class="variable">@teacher</span>_name);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@teacher</span>_name;</span><br><span class="line"></span><br><span class="line"># 查询指定id学生的年龄</span><br><span class="line">delimiter xx</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">PROCEDURE</span> myprocedure04(<span class="keyword">INOUT</span> <span class="keyword">parameter</span> <span class="type">INT</span>(<span class="number">3</span>))</span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		<span class="keyword">SELECT</span> age <span class="keyword">INTO</span> <span class="keyword">parameter</span> <span class="keyword">FROM</span>  student <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="keyword">parameter</span>;</span><br><span class="line">	<span class="keyword">END</span> xx</span><br><span class="line">delimiter ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@para</span><span class="operator">=</span><span class="number">2</span>;	</span><br><span class="line"><span class="keyword">CALL</span> myprocedure04(<span class="variable">@para</span>);# 调用存储过程</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@para</span>;</span><br></pre></td></tr></table></figure>

<h2 id="4-6-函数"><a href="#4-6-函数" class="headerlink" title="4.6 函数"></a>4.6 函数</h2><h3 id="4-6-1-预定义函数"><a href="#4-6-1-预定义函数" class="headerlink" title="4.6.1 预定义函数"></a>4.6.1 预定义函数</h3><p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 数学函数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">abs</span>(<span class="number">-100</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">sqrt</span>(<span class="number">9</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">mod</span>(<span class="number">10</span>,<span class="number">3</span>);</span><br><span class="line"><span class="keyword">SELECT</span> rand();</span><br><span class="line"><span class="keyword">SELECT</span> pow(<span class="number">2</span>,<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"># 字符串函数</span><br><span class="line"><span class="keyword">SELECT</span> length(&quot;abc123&quot;);</span><br><span class="line"><span class="keyword">SELECT</span> concat(&quot;abc&quot;,&quot;123&quot;);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">substring</span>(&quot;abc123&quot;,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"># 日期时间函数</span><br><span class="line"><span class="keyword">SELECT</span> 	curdate();</span><br><span class="line"><span class="keyword">SELECT</span>	curtime()</span><br><span class="line"><span class="keyword">SELECT</span>	now();</span><br><span class="line"><span class="keyword">SELECT</span>	<span class="keyword">year</span>(now());</span><br><span class="line"><span class="keyword">SELECT</span>	<span class="keyword">month</span>(now());</span><br><span class="line"><span class="keyword">SELECT</span>	<span class="keyword">day</span>(now());</span><br><span class="line"><span class="keyword">SELECT</span>	<span class="keyword">hour</span>(now());</span><br><span class="line"><span class="keyword">SELECT</span>	<span class="keyword">minute</span>(now());</span><br><span class="line"><span class="keyword">SELECT</span>	<span class="keyword">second</span>(now());</span><br><span class="line"><span class="keyword">SELECT</span>	DATE_FORMAT(now(),&quot;%y年%m月%d日 %H时%i分%s秒&quot;);</span><br></pre></td></tr></table></figure>

<h3 id="4-6-2-自定义函数"><a href="#4-6-2-自定义函数" class="headerlink" title="4.6.2 自定义函数"></a>4.6.2 自定义函数</h3><p>示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># 自定义函数</span><br><span class="line"></span><br><span class="line"># 函数入门</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">FUNCTION</span> method01()	<span class="keyword">RETURNS</span> <span class="type">INT</span>(<span class="number">3</span>) <span class="keyword">RETURN</span> <span class="number">666</span>;</span><br><span class="line"><span class="keyword">SELECT</span> method01();# 调用函数</span><br><span class="line"></span><br><span class="line"># 有返回值的函数</span><br><span class="line"># 需求：查询指定id的学生所属的学科名称，并返回</span><br><span class="line">delimiter xx</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">FUNCTION</span> method02(s_id <span class="type">int</span>(<span class="number">3</span>)) <span class="keyword">RETURNS</span> <span class="type">VARCHAR</span>(<span class="number">32</span>)</span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		<span class="keyword">DECLARE</span> course_name <span class="type">VARCHAR</span>(<span class="number">32</span>);# 创建变量</span><br><span class="line">		<span class="keyword">SELECT</span> name <span class="keyword">INTO</span> course_name <span class="keyword">FROM</span> course <span class="keyword">WHERE</span> id<span class="operator">=</span>(<span class="keyword">SELECT</span> course_id <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id <span class="operator">=</span> s_id);</span><br><span class="line">		<span class="keyword">RETURN</span> course_name;</span><br><span class="line">	<span class="keyword">END</span> xx</span><br><span class="line">delimiter ;</span><br><span class="line"><span class="keyword">SELECT</span> method02(<span class="number">6</span>);</span><br><span class="line"></span><br><span class="line"># 需求：查询指定id的学生年龄，并返回</span><br><span class="line">delimiter xx</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">FUNCTION</span> method03(s_id <span class="type">int</span>(<span class="number">3</span>)) <span class="keyword">RETURNS</span> <span class="type">INT</span>(<span class="number">3</span>)</span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		<span class="keyword">DECLARE</span> s_age <span class="type">INT</span>(<span class="number">3</span>);# 创建变量</span><br><span class="line">		<span class="keyword">SELECT</span> age <span class="keyword">INTO</span> s_age <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> id<span class="operator">=</span> s_id;</span><br><span class="line">		<span class="keyword">RETURN</span> s_age;</span><br><span class="line">	<span class="keyword">END</span> xx</span><br><span class="line">delimiter ;</span><br><span class="line"><span class="keyword">SELECT</span> method03(<span class="number">7</span>);</span><br><span class="line"></span><br><span class="line"># 删除函数</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> method03;</span><br></pre></td></tr></table></figure>

<h2 id="4-7-事务"><a href="#4-7-事务" class="headerlink" title="4.7 事务"></a>4.7 事务</h2><h3 id="4-7-1-事务的应用"><a href="#4-7-1-事务的应用" class="headerlink" title="4.7.1 事务的应用"></a>4.7.1 事务的应用</h3><p>MySQL：每一条语句都属于独立事务,默认自动管理提交的。</p>
<p>如果需要把多条语句当成一个整体，那么就需要把多条语句放在一个事务里面</p>
<p>开启事务：start transaction</p>
<p>提交事务：commit;</p>
<p>回滚事务：rollback</p>
<p>sql语句示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION;# 开启事物</span><br><span class="line">UPDATE bank <span class="keyword">SET</span> money<span class="operator">=</span>money<span class="number">-200</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">UPDATE bank <span class="keyword">SET</span> money<span class="operator">=</span>money<span class="operator">+</span><span class="number">200</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"># <span class="keyword">ROLLBACK</span>   <span class="comment">---回滚事物</span></span><br></pre></td></tr></table></figure>

<p>如果所有的SQL语句都正确执行，则成功。</p>
<p>如果有一条语句执行失败，事务中所有的语句都会取消执行。例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION;# 开启事物</span><br><span class="line">UPDATE bank <span class="keyword">SET</span> money<span class="operator">=</span>money<span class="number">-200</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">UPDATE bank <span class="keyword">SET</span> m<span class="operator">=</span>m<span class="number">-200</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">UPDATE bank <span class="keyword">SET</span> money<span class="operator">=</span>money<span class="operator">+</span><span class="number">200</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>事物在JDBC中的使用：见javaWeb基础1:JDBC </p>
<h3 id="4-7-2-事务的特点（ACID）"><a href="#4-7-2-事务的特点（ACID）" class="headerlink" title="4.7.2 事务的特点（ACID）"></a>4.7.2 事务的特点（ACID）</h3><p>原子性（ Atomicity ）、一致性（ Consistency ）、隔离性（ Isolation ）和持久性（ Durability ）  </p>
<p>解释：</p>
<ol>
<li><p>原子性：事务是数据库的逻辑工作单位，事务中包含的各操作要么都完成，要么都不完成</p>
</li>
<li><p>一致性：事务执行的结果必须是使数据库从一个一致性状态变到另一个一致性状态。因此当数据库只包含成功事务提交的结果时，就说数据库处于一致性状态。如果数据库系统 运行中发生故障，有些事务尚未完成就被迫中断，这些未完成事务对数据库所做的修改有一部分已写入物理数据库，这时数据库就处于一种不正确的状态，或者说是 不一致的状态。</p>
</li>
<li><p>隔离性：一个事务的执行不能其它事务干扰。即一个事务内部的操作及使用的数据对其它并发事务是隔离的，并发执行的各个事务之间不能互相干扰。</p>
</li>
<li><p>持久性：指一个事务一旦提交，它对数据库中的数据的改变就应该是永久性的。接下来的其它操作或故障不应该对其执行结果有任何影响。</p>
</li>
</ol>
<h3 id="4-7-3-事务的隔离级别"><a href="#4-7-3-事务的隔离级别" class="headerlink" title="4.7.3 事务的隔离级别"></a>4.7.3 事务的隔离级别</h3><p>属于事务的。都已开启了事务为前提。</p>
<p>不考虑事务的隔离级别，会出现以下错误的情况</p>
<ol>
<li><p>脏读：一个线程中的事务读到了另外一个线程中未提交的数据。</p>
</li>
<li><p>不可重复读：一个线程中的事务读到了另外一个线程中已经提交的update的数据。</p>
</li>
<li><p>虚读：一个线程中的事务读到了另外一个线程中已经提交的insert的数据。</p>
</li>
</ol>
<p>要想避免以上现象，通过更改事务的隔离级别来避免：</p>
<ol>
<li><p>READ UNCOMMITTED 脏读、不可重复读、虚读有可能发生。</p>
</li>
<li><p>READ COMMITTED 避免脏读的发生，不可重复读、虚读有可能发生。</p>
</li>
<li><p>REPEATABLE READ 避免脏读、不可重复读的发生，虚读有可能发生。</p>
</li>
<li><p>SERIALIZABLE 避免脏读、不可重复读、虚读的发生。</p>
</li>
</ol>
<p>别依次升高，效率依次降低。</p>
<p>MySQL：默认REPEATABLE READ</p>
<p>ORACLE：默认READ COMMITTED</p>
<p>MySQL：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="variable">@tx</span>_isolation; #查看当前的隔离级别</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> transaction isolation level SERIALIZABLE <span class="operator">/</span><span class="operator">/</span>级别设置当前的事务隔离级别</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yolukami.com/2021/10/11/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/" data-id="ckvuq2kyo00006sonhum39qfo" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2021/10/11/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93MySQL/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">关系型数据库MySQL</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/">MySQL数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/">Python基础学习</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/">Python算法入门</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/markdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/">markdown基本语法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/10/11/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/">mysql数据库基础</a>
          </li>
        
          <li>
            <a href="/2021/10/11/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93MySQL/">关系型数据库MySQL</a>
          </li>
        
          <li>
            <a href="/2021/09/13/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B/">数据分析流程</a>
          </li>
        
          <li>
            <a href="/2021/09/13/python%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8/">基础排序算法</a>
          </li>
        
          <li>
            <a href="/2021/09/13/Python%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/Python%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%B8%80%EF%BC%89/">Python基础学习（一）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Yolukami<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>